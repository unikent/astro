<template>
<div v-else class="empty-region">

	<el-alert
		title="We left this space free for you to add some optional blocks to your page."
		description="This part of the page will be hidden if you choose not to add any blocks into it."
		type="info"
		:closable="false"
		show-icon
	>
	</el-alert>

	<el-button size="large" @click="addBlocks">Add a block</el-button>
</div>
</template>

<script>
import { mapMutations } from 'vuex';
import { Definition } from 'classes/helpers';
import { allowedOperations } from 'classes/SectionConstraints';
export default {

	name: 'empty-section',

	props: {
		// The name of the region containing this section
		region: {
			type: String,
			required: true
		},

		// The index in its region of this section
		section: {
			type: Number,
			required: true
		},

		// The section data
		sectionData: {
			type: Object,
			required: true
		},
	},

	methods: {

		...mapMutations([
			'showBlockPicker',
			'updateInsertIndex',
			'updateInsertRegion'
		]),

		addBlocks() {
			const
				sectionDefinition = this.sectionData ?
					Definition.getRegionSectionDefinition(this.region, this.section) : null,
				sectionConstraints = this.sectionData ?
					allowedOperations(this.sectionData.blocks, sectionDefinition) : null,
				deprecatedBlocks = sectionDefinition.deprecatedBlocks ? sectionDefinition.deprecatedBlocks : [],
				maxBlocks = sectionDefinition.max || sectionDefinition.size;

			this.showBlockPicker({
				insertIndex: 0,
				sectionIndex: this.section,
				regionName: this.region,
				blocks: sectionConstraints ? sectionConstraints.allowedBlocks : [],
				deprecatedBlocks: deprecatedBlocks,
				maxSelectableBlocks: maxBlocks
			});
		}
	}

};
</script>
